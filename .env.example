# ---------------------
# Core application auth
# ---------------------
# Human friendly name for the FastAPI app.
APP_NAME="Multimodal RAG SaaS"
# JSON map of API keys to user identifiers (for rate limiting + storage isolation).
API_KEYS='{"test-key": "test-user"}'
# Redis endpoint used for request throttling and Celery coordination.
REDIS_URL="redis://localhost:6379/0"

# ---------------------
# Model configuration
# ---------------------
# Sentence embedding model for text nodes and queries.
MODEL_TEXT="sentence-transformers/all-MiniLM-L6-v2"
# CLIP vision backbone used for image embeddings.
MODEL_CLIP="openai/clip-vit-base-patch32"
# Cross-encoder reranker for text retrieval refinement.
RERANKER_MODEL="cross-encoder/ms-marco-MiniLM-L-6-v2"

# ---------------------
# Gemini generation
# ---------------------
# Google API key for Gemini access.
GEMINI_API_KEY="your-google-api-key-here"
# Gemini multimodal model identifier.
GEMINI_MODEL="gemini-pro-vision"

# ---------------------
# Storage paths
# ---------------------
# Root directory for LanceDB vector storage.
LANCEDB_DIR="output/lance_db"
# Where uploaded media artifacts are stored.
MEDIA_DIR="output/media"
# Location for generated thumbnails and previews.
THUMBS_DIR="output/thumbs"
# Ingest cache for intermediate files (transcripts, frames, etc.).
INGEST_CACHE_DIR="output/cache"
# SQLite database for generated notes/quizzes.
NOTES_DB_PATH="output/notes.db"
# Directory for workflow checkpoints or graph states.
CHECKPOINT_DIR="output/checkpoints"

# ---------------------
# Retrieval behaviour
# ---------------------
# Request budget per minute per API key.
RATE_LIMIT_PER_MIN=60
# Text candidates pulled from LanceDB before reranking.
INDEX_TOPK_TEXT=50
# Image candidates pulled from LanceDB before reranking.
INDEX_TOPK_IMG=12
# Toggle cross-encoder reranking (true/false).
RERANK_ENABLED=true
# Depth for cross-encoder reranking.
RERANK_TOPK=8
# Final number of multimodal results returned to generators.
FINAL_N=4
# Confidence threshold for fallback behaviour.
CONFIDENCE_TAU=0.25
# Character chunk size for PDF/text ingestion.
CHUNK_SIZE_CHARS=1200
# Character overlap between sequential chunks.
CHUNK_OVERLAP_CHARS=200
# Comma-separated list of allowed upload extensions.
ALLOWED_UPLOAD_EXTS=".pdf"

# ---------------------
# YouTube ingestion
# ---------------------
# Prefer transcript-first ingestion for latency savings.
YT_PREFER_TRANSCRIPT=true
# Scene-change threshold for frame sampling.
YT_FRAME_SCENE_THRESH=0.4
# Maximum number of frames to persist per video.
YT_MAX_FRAMES=120
# Perceptual hash distance used to drop near-duplicate frames.
YT_FRAME_DEDUP_DELTA=6
# Baseline frame stride in seconds before scene-change overrides.
YT_FRAME_STRIDE_SEC=5
# Defer frame extraction until needed when set to true.
YT_LAZY_FRAMES=true
# Primary frame extraction backend (ffmpeg or opencv).
YT_FRAME_EXTRACTOR="ffmpeg"
# Reject videos longer than this many minutes (0 disables).
YT_MAX_DURATION_MIN=40
# yt-dlp format selector for video downloads.
YT_DOWNLOAD_FORMAT="bv*[height<=360]+ba/b[height<=360]"
# Maximum retry attempts for yt-dlp.
YT_RETRIES=2
# Timeout in seconds for individual ingest stages.
YT_TIMEOUT_SEC=120

# ---------------------
# Study notes & quizzes
# ---------------------
# Character context budget when building study notes.
NOTE_CONTEXT_CHARS=4000
# Number of quiz questions generated per video/document.
QUIZ_QUESTION_COUNT=5
